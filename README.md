# OneClickVirt

## ğŸ“– é¡¹ç›®ç®€ä»‹

OneClickVirtæ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„è™šæ‹ŸæœåŠ¡ç®¡ç†å¹³å°ï¼Œæ”¯æŒå¤šç§è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œæä¾›å®Œæ•´çš„äº§å“ç®¡ç†ã€ç”¨æˆ·ç®¡ç†ã€è®¢å•ç®¡ç†å’Œèµ„æºç›‘æ§åŠŸèƒ½ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æœ¬åœ°å¼€å‘

#### å‰ç«¯å¼€å‘
```bash
cd web
npm install
npm run dev
```

å‰ç«¯å°†è¿è¡Œåœ¨ `http://localhost:8080`

#### åç«¯å¼€å‘
```bash
cd server
go mod download
go run main.go
```

åç«¯å°†è¿è¡Œåœ¨ `http://localhost:8890`

### Dockeréƒ¨ç½²

#### ä½¿ç”¨docker-compose (æ¨è)

```bash
docker-compose -f docker-compose.yaml up -d
```

æˆ–

```bash
docker-compose up -d
```

#### æ‰‹åŠ¨æ„å»ºå’Œè¿è¡Œ

1. æ„å»ºé•œåƒ
```bash
docker build -t oneclickvirt .
```

2. è¿è¡Œå®¹å™¨

**åŸºæœ¬è¿è¡Œï¼ˆHTTPï¼‰**
```bash
docker run -d --name oneclickvirt -p 80:80 -e FRONTEND_URL="http://your-domain.com" oneclickvirt
```

**ä½¿ç”¨HTTPSï¼ˆè‡ªåŠ¨ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼‰**
```bash
docker run -d --name oneclickvirt -p 80:80 -p 443:443 -e FRONTEND_URL="https://your-domain.com" oneclickvirt
```

**ä½¿ç”¨è‡ªå®šä¹‰SSLè¯ä¹¦**
```bash
docker run -d --name oneclickvirt \
  -p 80:80 -p 443:443 \
  -e FRONTEND_URL="https://your-domain.com" \
  -e SSL_CERT_PATH="/certs/cert.pem" \
  -e SSL_KEY_PATH="/certs/key.pem" \
  -v /path/to/your/certs:/certs \
  oneclickvirt
```

**æ•°æ®æŒä¹…åŒ–è¿è¡Œï¼ˆæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰**
```bash
# åˆ›å»ºæ•°æ®ç›®å½•
mkdir -p docker-data/mysql docker-data/storage docker-data/ssl

# è¿è¡Œå®¹å™¨ï¼ˆå¸¦æ•°æ®å·æŒ‚è½½ï¼‰
docker run -d --name oneclickvirt \
  -p 80:80 -p 443:443 \
  -v $(pwd)/docker-data/mysql:/var/lib/mysql \
  -v $(pwd)/docker-data/storage:/app/storage \
  -v $(pwd)/docker-data/ssl:/etc/nginx/ssl \
  -v $(pwd)/docker-data/config.yaml:/app/config.yaml \
  oneclickvirt
```

**ç¯å¢ƒå˜é‡è¯´æ˜**
- `FRONTEND_URL`: å‰ç«¯è®¿é—®URLï¼ˆå¦‚ `https://your-domain.com` æˆ– `http://your-domain.com`ï¼‰
- `SSL_CERT_PATH`: SSLè¯ä¹¦æ–‡ä»¶è·¯å¾„ï¼ˆå¯é€‰ï¼‰
- `SSL_KEY_PATH`: SSLç§é’¥æ–‡ä»¶è·¯å¾„ï¼ˆå¯é€‰ï¼‰

**æ•°æ®æŒä¹…åŒ–è¯´æ˜**
- `docker-data/mysql`: MySQLæ•°æ®åº“æ–‡ä»¶ï¼ˆç”¨æˆ·æ•°æ®ã€è®¢å•ã€é…ç½®ç­‰ï¼‰
- `docker-data/storage`: åº”ç”¨å­˜å‚¨ï¼ˆæ—¥å¿—ã€ä¸Šä¼ æ–‡ä»¶ã€ç¼“å­˜ç­‰ï¼‰
- `docker-data/ssl`: SSLè¯ä¹¦æ–‡ä»¶
- `docker-data/config.yaml`: åº”ç”¨é…ç½®æ–‡ä»¶

âš ï¸ **é‡è¦æç¤º**: ä½¿ç”¨æ•°æ®å·æŒ‚è½½åï¼Œå³ä½¿åˆ é™¤å®¹å™¨ï¼Œæ•°æ®ä¹Ÿä¼šä¿ç•™åœ¨å®¿ä¸»æœºä¸Šã€‚é‡æ–°åˆ›å»ºå®¹å™¨æ—¶åªéœ€ä½¿ç”¨ç›¸åŒçš„ `-v` å‚æ•°å³å¯æ¢å¤æ•°æ®ã€‚

#### æ•°æ®åˆå§‹åŒ–

**é¦–æ¬¡éƒ¨ç½²ï¼ˆæ— æ•°æ®æŒä¹…åŒ–ï¼‰**

é¦–æ¬¡éƒ¨ç½²æ—¶ï¼Œè®¿é—®ç½‘ç«™ä¼šè‡ªåŠ¨è·³è½¬åˆ°åˆå§‹åŒ–é¡µé¢ï¼ŒæŒ‰ç…§æç¤ºè®¾ç½®ç®¡ç†å‘˜è´¦æˆ·å³å¯ã€‚

**ä½¿ç”¨æ•°æ®æŒä¹…åŒ–æ—¶çš„åˆå§‹åŒ–**

å¦‚æœä½¿ç”¨æ•°æ®å·æŒ‚è½½éƒ¨ç½²ï¼Œéœ€è¦æ‰‹åŠ¨åˆå§‹åŒ–æ•°æ®åº“ï¼š

```bash
# æ–¹æ³•1: åœ¨å®¹å™¨å†…æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬
docker exec -it oneclickvirt bash /app/scripts/init.sh --docker-internal

# æ–¹æ³•2: ä»å®¿ä¸»æœºæ‰§è¡Œ
./scripts/init.sh oneclickvirt

# æ–¹æ³•3: æ‰‹åŠ¨å¯¼å…¥SQL
docker exec -i oneclickvirt mysql -uroot oneclickvirt < scripts/init.sql
```

åˆå§‹åŒ–å®Œæˆåï¼Œä½¿ç”¨ä»¥ä¸‹è´¦æˆ·ç™»å½•ï¼š
- **ç”¨æˆ·å**: `admin`
- **å¯†ç **: `admin123456`

âš ï¸ é¦–æ¬¡ç™»å½•åè¯·ç«‹å³ä¿®æ”¹å¯†ç ï¼

**é‡ç½®æ•°æ®**

å¦‚éœ€é‡ç½®æ‰€æœ‰æ•°æ®ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# åœæ­¢å¹¶åˆ é™¤å®¹å™¨
docker stop oneclickvirt && docker rm oneclickvirt

# åˆ é™¤æ•°æ®ç›®å½•ï¼ˆè°¨æ…æ“ä½œï¼ï¼‰
rm -rf docker-data/mysql/*
rm -f docker-data/storage/.system_initialized

# é‡æ–°å¯åŠ¨å®¹å™¨
docker run -d --name oneclickvirt ...
```

#### æ‰‹åŠ¨æ„å»º

1. æ„å»ºå‰ç«¯
```bash
cd web
npm install
npm run build
```

2. æ„å»ºåç«¯
```bash
cd server
go build -o oneclickvirt main.go
```

3. è¿è¡ŒæœåŠ¡
```bash
./server/oneclickvirt
```

## ğŸ” ç™»å½•ä¿¡æ¯

**æœ¬åœ°å¼€å‘ç¯å¢ƒ:**
```
å‰ç«¯åœ°å€: http://localhost:8080
åç«¯API:  http://localhost:8890

ç®¡ç†å‘˜è´¦å·:
  ç”¨æˆ·å: admin
  å¯†ç :   admin123456
```

**Dockeréƒ¨ç½²ç¯å¢ƒ:**
```
å‰ç«¯åœ°å€: http://your-domain.com (æˆ– https://your-domain.com)
åç«¯API:  è‡ªåŠ¨é…ç½®ï¼Œæ— éœ€æ‰‹åŠ¨è®¿é—®

ç®¡ç†å‘˜è´¦å·:
  ç”¨æˆ·å: admin
  å¯†ç :   admin123456
```

âš ï¸ é¦–æ¬¡ç™»å½•åå»ºè®®ç«‹å³ä¿®æ”¹å¯†ç !

## ğŸŒ éƒ¨ç½²é€‰é¡¹

### æœ¬åœ°éƒ¨ç½²
- é€‚åˆå¼€å‘å’Œæµ‹è¯•ç¯å¢ƒ
- å¿«é€Ÿå¯åŠ¨ï¼Œä¾¿äºè°ƒè¯•

### Dockeréƒ¨ç½²
- é€‚åˆç”Ÿäº§ç¯å¢ƒ
- åŒ…å«å®Œæ•´çš„æœåŠ¡æ ˆ
- ä¾¿äºæ‰©å±•å’Œç»´æŠ¤

### äº‘æœåŠ¡å™¨éƒ¨ç½²
- é€‚åˆçº¿ä¸Šç”Ÿäº§ç¯å¢ƒ
- æ”¯æŒé«˜å¯ç”¨é…ç½®

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ç®¡ç†å‘˜åŠŸèƒ½
- âœ… ç«™ç‚¹é…ç½®ç®¡ç†
- âœ… äº§å“å¥—é¤ç®¡ç†
- âœ… å…‘æ¢ç ç®¡ç†
- âœ… è®¢å•ç®¡ç†
- âœ… ç”¨æˆ·ç®¡ç†
- âœ… èµ„æºç›‘æ§
- âœ… æµé‡ç»Ÿè®¡
- âœ… **ä»£ç”¨æˆ·ç™»å½•** - ç®¡ç†å‘˜å¯ç›´æ¥ä»¥ç”¨æˆ·èº«ä»½ç™»å½•ç³»ç»Ÿ
- âœ… **å®ä¾‹è½¬ç§»å½’å±** - ç®¡ç†å‘˜å¯å°†å®ä¾‹ä»ä¸€ä¸ªç”¨æˆ·è½¬ç§»åˆ°å¦ä¸€ä¸ªç”¨æˆ·
- âœ… **ç¬¬ä¸‰æ–¹æ”¯ä»˜é…ç½®** - æ”¯æŒæ˜“æ”¯ä»˜å’Œç æ”¯ä»˜æ¥å£é…ç½®ï¼ˆè¯¦è§ä¸‹æ–¹é…ç½®è¯´æ˜ï¼‰

### ç”¨æˆ·åŠŸèƒ½
- âœ… è™šæ‹Ÿå®ä¾‹ç®¡ç†
- âœ… äº§å“è´­ä¹°
- âœ… é’±åŒ…ç®¡ç†
- âœ… è®¢å•ç®¡ç†
- âœ… æµé‡ç›‘æ§
- âœ… **å¤šç§æ”¯ä»˜æ–¹å¼** - æ”¯æŒæ”¯ä»˜å®ã€å¾®ä¿¡æ”¯ä»˜ã€ä½™é¢æ”¯ä»˜ã€æ˜“æ”¯ä»˜ã€ç æ”¯ä»˜

## ğŸ“ é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ deploy/           # éƒ¨ç½²ç›¸å…³é…ç½®
â”‚   â”œâ”€â”€ default.conf     # Nginxé…ç½®
â”‚   â”œâ”€â”€ my.cnf           # MySQLé…ç½®
â”‚   â”œâ”€â”€ nginx.dockerfile # Nginx Dockerfile
â”‚   â””â”€â”€ server.dockerfile # åç«¯æœåŠ¡Dockerfile
â”œâ”€â”€ server/           # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ api/             # APIè·¯ç”±
â”‚   â”œâ”€â”€ config/          # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ model/           # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ provider/        # è™šæ‹ŸåŒ–æä¾›å•†
â”‚   â””â”€â”€ main.go          # ä¸»å…¥å£
â”œâ”€â”€ web/              # å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ src/             # æºç 
â”‚   â”œâ”€â”€ Dockerfile       # å‰ç«¯Dockerfile
â”‚   â””â”€â”€ package.json     # ä¾èµ–ç®¡ç†
â”œâ”€â”€ docker-compose.yaml # Docker Composeé…ç½®
â””â”€â”€ README.md          # é¡¹ç›®è¯´æ˜
```

## ğŸ”§ æŠ€æœ¯æ ˆ

### åç«¯
- Go 1.24
- Gin Webæ¡†æ¶
- GORM ORMæ¡†æ¶
- MySQL / SQLite
- Redis (å¯é€‰)

### å‰ç«¯
- Vue 3
- Element Plus UIæ¡†æ¶
- Viteæ„å»ºå·¥å…·

### æ–°å¢æŠ€æœ¯ç»„ä»¶
- **JWT Tokenè®¤è¯** - æ”¯æŒç®¡ç†å‘˜ä»£ç”¨æˆ·ç™»å½•çš„æƒé™é™çº§
- **MD5ç­¾åéªŒè¯** - ç¬¬ä¸‰æ–¹æ”¯ä»˜å›è°ƒå®‰å…¨éªŒè¯
- **å¼‚æ­¥æ”¯ä»˜å¤„ç†** - æ”¯æŒå¤šå¹³å°æ”¯ä»˜å›è°ƒå¤„ç†

## ğŸ“ å¼€å‘è§„èŒƒ

### åç«¯
- éµå¾ªGoè¯­è¨€æœ€ä½³å®è·µ
- åˆ†å±‚æ¶æ„è®¾è®¡
- RESTful APIè®¾è®¡
- è¯¦ç»†çš„æ—¥å¿—è®°å½•

### å‰ç«¯
- ç»„ä»¶åŒ–å¼€å‘
- TypeScriptæ”¯æŒ
- å“åº”å¼è®¾è®¡
- ç°ä»£åŒ–UIé£æ ¼

## ğŸ”’ å®‰å…¨æªæ–½

- JWTèº«ä»½è®¤è¯
- å¯†ç å“ˆå¸Œå­˜å‚¨
- æƒé™æ§åˆ¶
- é˜²æ­¢SQLæ³¨å…¥
- é˜²æ­¢XSSæ”»å‡»
- **æ”¯ä»˜ç­¾åéªŒè¯** - MD5ç­¾åç¡®ä¿æ”¯ä»˜å›è°ƒå®‰å…¨æ€§
- **æƒé™é™çº§æœºåˆ¶** - ç®¡ç†å‘˜ä»£ç”¨æˆ·ç™»å½•æ—¶æƒé™å®‰å…¨æ§åˆ¶
- **æ“ä½œå®¡è®¡æ—¥å¿—** - è®°å½•æ•æ„Ÿæ“ä½œä¾¿äºè¿½è¸ª

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Request!

1. Forké¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯
3. æäº¤ä¿®æ”¹
4. æ¨é€åˆ†æ”¯
5. åˆ›å»ºPull Request

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ’³ æ”¯ä»˜é…ç½®è¯´æ˜

### æ˜“æ”¯ä»˜ (Epay) é…ç½®

åœ¨åå°ç®¡ç† â†’ ç³»ç»Ÿè®¾ç½® â†’ æ”¯ä»˜é…ç½®ä¸­é…ç½®ä»¥ä¸‹å‚æ•°ï¼š

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `å•†æˆ·ID (PID)` | æ˜“æ”¯ä»˜å¹³å°åˆ†é…çš„å•†æˆ·ID | `1234` |
| `å•†æˆ·å¯†é’¥ (Key)` | æ˜“æ”¯ä»˜å¹³å°åˆ†é…çš„å•†æˆ·å¯†é’¥ | `your_secret_key_here` |
| `APIæ¥å£åœ°å€` | æ˜“æ”¯ä»˜å¹³å°çš„APIåœ°å€ | `https://pay.example.com/` |
| **å›è°ƒURL** | æ”¯ä»˜æˆåŠŸåçš„å¼‚æ­¥é€šçŸ¥åœ°å€ | `https://your-domain.com/api/v1/payment/epay/notify` |
| **è¿”å›URL** | æ”¯ä»˜æˆåŠŸåè·³è½¬çš„é¡µé¢åœ°å€ | `https://your-domain.com/user/wallet` |

âš ï¸ **é‡è¦æç¤º**:
- å›è°ƒURLå¿…é¡»æ˜¯å¤–ç½‘å¯è®¿é—®çš„HTTPSåœ°å€
- å›è°ƒURLæœ«å°¾**ä¸è¦**åŠ ç©ºæ ¼æˆ–å…¶ä»–å­—ç¬¦
- è¿”å›URLé€šå¸¸æ˜¯ç”¨æˆ·é’±åŒ…é¡µé¢æˆ–è®¢å•é¡µé¢
- ç¡®ä¿æ˜“æ”¯ä»˜å¹³å°çš„å›è°ƒç™½åå•ä¸­å·²æ·»åŠ æ‚¨çš„æœåŠ¡å™¨IP

### ç æ”¯ä»˜ (Mapay) é…ç½®

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `å•†æˆ·ID` | ç æ”¯ä»˜å¹³å°åˆ†é…çš„å•†æˆ·ID | `5678` |
| `å•†æˆ·å¯†é’¥` | ç æ”¯ä»˜å¹³å°åˆ†é…çš„å•†æˆ·å¯†é’¥ | `your_mapay_key_here` |
| `APIæ¥å£åœ°å€` | ç æ”¯ä»˜å¹³å°çš„APIåœ°å€ | `https://mapay.example.com/` |
| **å›è°ƒURL** | æ”¯ä»˜æˆåŠŸåçš„å¼‚æ­¥é€šçŸ¥åœ°å€ | `https://your-domain.com/api/v1/payment/mapay/notify` |
| **è¿”å›URL** | æ”¯ä»˜æˆåŠŸåè·³è½¬çš„é¡µé¢åœ°å€ | `https://your-domain.com/user/wallet` |

### æ”¯ä»˜é…ç½®æ£€æŸ¥æ¸…å•

- [ ] å·²å¯ç”¨å¯¹åº”çš„æ”¯ä»˜æ–¹å¼ï¼ˆæ˜“æ”¯ä»˜/ç æ”¯ä»˜ï¼‰
- [ ] å·²æ­£ç¡®å¡«å†™å•†æˆ·IDå’Œå¯†é’¥
- [ ] APIæ¥å£åœ°å€ä»¥ `/` ç»“å°¾
- [ ] å›è°ƒURLæ ¼å¼æ­£ç¡®ä¸”å¯è®¿é—®
- [ ] è¿”å›URLæŒ‡å‘æ­£ç¡®çš„é¡µé¢
- [ ] æ”¯ä»˜å¹³å°å·²é…ç½®å›è°ƒç™½åå•

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·åˆ›å»ºIssueæˆ–è”ç³»é¡¹ç›®ç»´æŠ¤è€…ã€‚

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«!** ğŸ‰
