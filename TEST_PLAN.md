# OneClickVirt 功能测试计划

## 测试目标
验证所有新增功能的正确性和稳定性，确保系统正常运行。

## 测试环境
- 操作系统: Windows 10/11
- 数据库: MySQL 8.0
- Go版本: 1.21+
- Node.js版本: 16+

## 测试用例

### 1. 管理员代用户登录功能测试

#### 1.1 前提条件
- 已登录管理员账号
- 存在至少一个普通用户账号

#### 1.2 测试步骤
1. 进入管理员后台 → 用户管理页面
2. 找到目标用户，点击"代登录"按钮
3. 确认操作后，系统应生成该用户的登录Token
4. 页面应自动跳转到用户登录后的界面
5. 验证用户权限和功能是否正常

#### 1.3 预期结果
- ✅ 管理员可以成功代登录到用户账户
- ✅ 代登录后显示的是用户界面而非管理员界面
- ✅ 用户的所有功能正常可用
- ✅ 管理员权限被正确降级为用户权限

### 2. 实例转移归属功能测试

#### 2.1 前提条件
- 已登录管理员账号
- 存在至少两个用户账号
- 至少有一个实例属于某个用户

#### 2.2 测试步骤
1. 进入管理员后台 → 实例管理页面
2. 选择一个实例，点击"转移归属"按钮
3. 在弹出的对话框中选择目标用户
4. 确认转移操作
5. 检查实例列表，确认归属已变更
6. 登录目标用户账户，确认能正常访问该实例

#### 2.3 预期结果
- ✅ 实例可以成功转移给其他用户
- ✅ 原用户失去对该实例的访问权限
- ✅ 新用户获得对该实例的完整访问权限
- ✅ 实例的配置和数据保持完整

### 3. 易支付接口测试

#### 3.1 前提条件
- 管理员已在后台配置易支付接口信息
- 易支付商户账号可用

#### 3.2 测试步骤
1. 用户进行充值或购买操作
2. 选择"易支付"作为支付方式
3. 系统生成支付订单并跳转到易支付页面
4. 完成支付后，易支付回调通知系统
5. 系统处理回调并更新订单状态
6. 检查用户余额或产品状态是否正确更新

#### 3.3 预期结果
- ✅ 易支付配置正确加载
- ✅ 支付页面正常跳转
- ✅ 回调签名验证通过
- ✅ 订单状态正确更新
- ✅ 用户余额或等级正确增加

### 4. 码支付接口测试

#### 4.1 前提条件
- 管理员已在后台配置码支付接口信息
- 码支付商户账号可用

#### 4.2 测试步骤
1. 用户进行充值或购买操作
2. 选择"码支付"作为支付方式
3. 系统生成支付订单并跳转到码支付页面
4. 完成支付后，码支付回调通知系统
5. 系统处理回调并更新订单状态
6. 检查用户余额或产品状态是否正确更新

#### 4.3 预期结果
- ✅ 码支付配置正确加载
- ✅ 支付页面正常跳转
- ✅ 回调签名验证通过
- ✅ 订单状态正确更新
- ✅ 用户余额或等级正确增加

### 5. 支付模块配置界面测试

#### 5.1 测试步骤
1. 管理员登录后台
2. 进入"系统配置" → "支付接口配置"页面
3. 检查各支付方式的配置选项是否完整显示
4. 尝试启用/禁用不同的支付方式
5. 填写并保存配置信息
6. 重新加载页面，验证配置是否正确保存

#### 5.2 预期结果
- ✅ 所有支付方式配置项完整显示
- ✅ 配置保存功能正常
- ✅ 配置信息持久化存储
- ✅ 界面交互流畅，无明显错误

### 6. 系统整体功能测试

#### 6.1 测试步骤
1. 启动完整的后端服务
2. 启动前端开发服务器
3. 执行完整的用户注册、登录流程
4. 进行实例创建、管理操作
5. 测试各种支付方式的完整流程
6. 验证管理员各项功能

#### 6.2 预期结果
- ✅ 系统启动正常，无编译错误
- ✅ 前后端通信正常
- ✅ 数据库连接正常
- ✅ 所有业务流程完整可用

## 测试工具
- Postman: API接口测试
- 浏览器开发者工具: 前端调试
- 数据库管理工具: 数据验证
- 日志查看工具: 系统日志分析

## 测试输出
- 测试报告文档
- 问题清单和修复建议
- 性能测试结果
- 安全性评估报告

## 风险评估
- 支付接口配置错误可能导致支付失败
- 权限控制不当可能造成安全风险
- 数据库迁移可能影响现有数据
- 并发操作可能引发数据一致性问题

## 测试时间安排
预计测试周期: 2-3天
- 第1天: 功能测试和基本流程验证
- 第2天: 边界条件测试和异常处理
- 第3天: 性能测试和安全测试

## 测试人员
- 开发人员自测
- 专业测试人员验证
- 用户验收测试